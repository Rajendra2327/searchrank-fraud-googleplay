<%@ page contentType="text/html; charset=iso-8859-1" language="java" import="java.sql.*" errorPage="" %>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
<title>like image</title>
</head>
 <%@ include file="connect.jsp" %>
            <%@ page import="java.util.*"%>
            <%@ page import="java.text.*"%>
            <%@ page import="java.util.Date"%>
            <%@ page import="java.sql.*"%>
            <%@ page import="com.oreilly.servlet.*,java.lang.*,java.text.SimpleDateFormat,java.io.*,javax.servlet.*, javax.servlet.http.*" %>
            <%@ page import ="java.util.*,java.security.Key,java.util.Random,javax.crypto.Cipher,javax.crypto.spec.SecretKeySpec"%>
            <%@ page import="org.bouncycastle.util.encoders.Base64"%>
            <%@ page import="java.util.Random,java.io.PrintStream, java.io.FileOutputStream, java.io.FileInputStream, java.security.DigestInputStream, java.math.BigInteger, java.security.MessageDigest, java.io.BufferedInputStream" %>
<body>
<%
						String type=request.getParameter("type");
						String count3=request.getParameter("k1");

                           int one= Integer.parseInt(request.getParameter("id"));	
							String aname=request.getParameter("aname");
							String user=(String)application.getAttribute("uname");
							
                            String query="select * from likes where aname='"+aname+"' and user='"+user+"' "; 
						   	Statement st=connection.createStatement();
						   	ResultSet rs=st.executeQuery(query);
					   		if ( rs.next())
					   		{
								 String query1="select * from application where id="+one+" ";
				  				 Statement st1=connection.createStatement();
				  				 ResultSet rs1=st1.executeQuery(query1);
				  				 if ( rs1.next() )
	  			  				 {
									int rank1=rs1.getInt("rank");
						                  
										int rank=rank1+1;
							%><h2><%out.print("You Have Already Liked This Application");%></h2>  <p align="center"><a href="U_FoundApp.jsp?id=<%=one%>&rank=<%=rank%>&type=<%=type%>" class="style47">Back</a></p><%
							}}
							else
							{
							PreparedStatement pst=connection.prepareStatement("insert into likes(user,aname) values(?,?)");
							pst.setString(1,user);
							pst.setString(2,aname);
							
							pst.executeUpdate();
								
								 String query1="select * from application where id="+one+" ";
				  				 Statement st1=connection.createStatement();
				  				 ResultSet rs1=st1.executeQuery(query1);
				  				 if ( rs1.next() )
	  			  				 {
									int rank1=rs1.getInt("rank");
						                  
										int rank=rank1+1;
							%><h2><%out.print("Thank You For Your Like ");%></h2>  <p align="center"><a href="U_FoundApp.jsp?id=<%=one%>&rank=<%=rank%>&type=<%=type%>" class="style47">Back</a></p><%
							}}

%>
</body>
</html>
